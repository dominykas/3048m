<% const Utils = require('../utils'); -%>

<table id="results-3048m" style="clear: both;" class="widget-wrapper">

    <thead>
        <tr>
            <th>Date</th>
            <% Object.keys(timeEntries.totals).forEach((k) => { %>
            <th colspan="2" style="padding-right: 14px;"><%= Utils.formatProjectHeading(projects, leaveTypes, k) %></th>
            <% }); %>
        </tr>
    </thead>

    <tbody class="tk-time-tracker">
        <% Utils.forEach(timeEntries.data, (dateKey, dayData) => {

            const rowProjectData = dayData.projects;
            const rowHours = Object.keys(rowProjectData).reduce((sum, projectKey) => sum + (rowProjectData[projectKey].hours || 0), 0);
        %>

        <% if (dayData.display) { %>
        <tr class="tk-time-tracker-row" style="<%= Utils.getRowStyle(dayData) %>">

            <td style="white-space: nowrap;padding-right: 14px;"><%= dateKey %></td>

            <% Utils.forEach(timeEntries.totals, (projectKey, projectData) => { %>
            <td class="<%- Utils.getHourCellClass(projects, leaveTypes, projectKey, projectData) %>"><div class="tk-hours">
                <%- Utils.getProjectHours(projectData, rowHours) %>
            </div></td>
            <td style="padding-right: 14px;">
                <%- projectData && projectData.notes || '' %>
                <% if (projectData && projectData.error) { %>
                <span style="color: #999;font-size: 10px;">Fix multiple entries in "Day" view</span>
                <% } %>
            </td>
            <% }) %>
        </tr>
        <% } %>

        <% if (dayData.lastOfMonth) { %>
        <tr class="tk-time-tracker-row" style="background-color:#e5e5e5;">

            <th scope="row"><%= dayData.month %></th>

            <% Object.keys(timeEntries.totals).forEach((k) => { %>
            <td colspan="2" style="padding-right: 14px;"><div class="tk-time-tracker-cel"><div class="tk-hours"><%= (timeEntries.totals[k][dayData.month] || 0) / 8 %> days</div></div></td>
            <% }); %>
        </tr>
        <% } %>

        <% }); %>
    </tbody>

</table>
